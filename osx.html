<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html charset=utf-8">
  <style>
    body {
      background-color: #333;
      color: #eee;
    }
  </style>
</head>

<body>

  <div id="title">
    Web layer for OSX
  </div>

  <script>
    window.isOSX = true
    window.Module = {}
    window.Module.createBuffer = async function(bytes) {
      const result = await _OSXcreateBuffer(bytes);
      return result.pointer
    }
    window.Module.sendMessageToCPP = (json) => {
      // In the web build, this is generated by emcc --bindings.
      _OSXsendMessageToCPP(json)
    }
    window.Module.HEAP8 = {
      set: (data, pointer) => {
        const encodedData = btoa(Array.prototype.map.call(data, function (ch) {
          return String.fromCharCode(ch);
        }).join(''));

        _OSXheap8Set(encodedData, pointer);
      }
    }
  </script>

  <!-- Call the app code as generated by TS -->
  <script src='output/app.js'></script>

  <script>
    setInterval(() => {
      document.getElementById('title').innerText += '.';
    }, 500);
  </script>

</body>

</html>
